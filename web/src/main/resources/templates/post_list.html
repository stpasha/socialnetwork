<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Post List</title>
</head>
<body>
<h1>Post List</h1>
<div>
    <form action="/posts" method="get">
        <label for="tag">Filter by Tag:</label>
        <select name="tag" id="tag" onchange="this.form.submit()">
            <option value="" th:selected="${selectedTag == null}">All</option>
            <option th:each="tag : ${tags}" th:value="${tag.name}" th:text="${tag.name}" th:selected="${selectedTag == tag.name}"></option>
        </select>
    </form>
</div>
<div>
    <a href="/posts/new">Add New Post</a>
</div>
<div th:each="post : ${posts}">
    <h2><a th:href="@{/posts/{id}(id=${post.id})}" th:text="${post.title}"></a></h2>
    <img th:src="${post.imageUrl}" alt="Post Image" style="max-width: 100px;">
    <p th:text="${#strings.abbreviate(post.content, 100)}"></p>
    <p>Likes: <span th:text="${#lists.size(post.likes)}"></span></p>
    <p>Comments: <span th:text="${#lists.size(post.comments)}"></span></p>
    <p th:each="tag : ${post.tags}" th:text="${tag.name}"></p>
</div>
<div>
    <a th:href="@{/posts(size=10, page=${currentPage - 1})}" th:if="${currentPage > 0}">Previous</a>
    <a th:href="@{/posts(size=10, page=${currentPage + 1})}">Next</a>
</div>
</body>
</html>